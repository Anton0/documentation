{{ $dot := .}}
{{ $d := .context.Site.Data.api.v1.full_spec_deref }}
{{ range $key, $value := .data }}

    {{/*
        We actually only care about properties not items, however properties appear inside items.
        So only pass .items.properties when we have .items
    */}}

    {{ $s := newScratch }}
    {{ if reflect.IsMap $value }}
      {{ with $value.properties }}
        {{ $s.Set "data" . }}
      {{ end }}
      {{ with $value.items }}
          {{ if reflect.IsMap . }}
            {{ with .properties }}
              {{ $s.Set "data" . }}
            {{ else }}
              {{ $s.Set "data" . }}
            {{ end }}
          {{ end }}
      {{ end }}
    {{ end }}
    {{ $childData := ($s.Get "data") }}

    <div class="row {{ if eq $dot.isNested true}} isNested d-none {{end}} {{ if $childData }} hasChildData {{ else }} {{ end }}">
      <div class="col-12">

          {{ if ne $key "example"}}
            <div class="row first-row {{if $childData}} js-collapse-trigger collapse-trigger {{ end }}">
              <div class="col-4 pl-0">
                <p class="key">{{ if $childData }}<span style="font-size: 18px">></span>{{ end }}
                {{ $key }}
              </p>
              </div>
              {{ if reflect.IsMap $value }}

                  {{ $readOnly := cond (eq $value.readOnly true ) "<span class='read-only'>&nbsp;üÜÅ</span>" ""}}
              
                  {{ if $value.type }}
                    <div class="col-2"><p>{{ $value.type }}{{$readOnly | safeHTML }}</p></div>
                  {{ else if $value.format }}
                    <div class="col-2"><p>{{ $value.format }}{{$readOnly | safeHTML }}</p></div>
                  {{ end }}
                  
              <div class="col-6">
                  {{ with $value.description }}
                    {{ if reflect.IsMap . }}
                    {{ else }}
                      <p>{{- ((replace . "\n" " ") | safeHTML) | markdownify -}}</p>
                    {{ end }}
                  {{ end }}
              </div>
              {{ else }}
                  <div class="col-4"><p>{{ $value }}</p></div>
                  <div class="col-4"><p>&nbsp;</p></div>
              {{ end }}

            </div>
            {{ end }}
      
          {{ partial "api/table-row-recursive.html" (dict "context" $dot.context "data" $childData "isNested" true) }}

      </div>
    </div>

        

{{ end }}
